#include "Morse.h"

String setning = "Eitthvad";

Morse dulkodi;

unsigned int t = 100;
unsigned int dotTime = t;
unsigned int dashTime = 3 * t;
unsigned int endwordTime = 7 * t;
unsigned int endCharTime = 5 * t;
int outPin = 6;
unsigned int currentTime;

void setup()
{
	pinMode(outPin, OUTPUT);
	digitalWrite(outPin, LOW);
}

void loop()
{
	String morse;
	for (unsigned int i = 0; i < setning.length(); i++)
	{
		if(setning[i] == ' ')
		{
			currentTime = millis();
			while(millis() - currentTime < endwordTime)
			{
				digitalWrite(outPin, HIGH);
			}
			digitalWrite(outPin, LOW);
		}
		else
		{
			morse = dulkodi.getChars(setning[i]);
			for (unsigned int j = 0; j < morse.length(); j++)
		{
			if (morse[j] == '.')
			{
				currentTime = millis();
				while (millis() - currentTime < dotTime)
				{
					digitalWrite(outPin, HIGH);
				}
				digitalWrite(outPin, LOW);
			}
			else if (morse[j] == '-')
			{
				currentTime = millis();
				while (millis() - currentTime < dashTime)
				{
					digitalWrite(outPin, HIGH);
				}
				digitalWrite(outPin, LOW);
			}
			currentTime = millis();
			while (millis() - currentTime < dotTime)
			{
				digitalWrite(outPin, HIGH);
			}
			digitalWrite(outPin, LOW);
		}
		currentTime = millis();
		while (millis() - currentTime < endCharTime)
		{
			digitalWrite(outPin, HIGH);
		}
		digitalWrite(outPin, LOW);
	}
}

}
