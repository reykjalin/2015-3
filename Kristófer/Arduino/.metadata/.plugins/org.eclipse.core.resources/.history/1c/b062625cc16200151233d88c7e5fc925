#include "Morse.h"

String setning = "EITTHVAD";

Morse dulkodi;

unsigned int t = 500;
unsigned int dotTime = t;
unsigned int dashTime = 3 * t;
unsigned int endwordTime = 7 * t;
unsigned int endCharTime = 5 * t;
int outPin = 10;
unsigned int currentTime;

void setup()
{
	pinMode(outPin, OUTPUT);
	digitalWrite(outPin, LOW);
	Serial.begin(9600);
}

void loop()
{
	String morse;
	for (unsigned int i = 0; i < setning.length(); i++)
	{
		if(setning.charAt(i) == ' ')
		{
			Serial.println("space");
			currentTime = millis();
			digitalWrite(outPin, HIGH);
			delay(endwordTime);
			digitalWrite(outPin, LOW);
		}
		else
		{
			Serial.println("not space");
			morse = dulkodi.getChars(setning.charAt(i));
			Serial.println(morse);
			for (unsigned int j = 0; j < morse.length(); j++)
			{
				if (morse.charAt(j) == '.')
				{
					Serial.println("dot");
					currentTime = millis();
					digitalWrite(outPin, HIGH);
					delay(dotTime);
					digitalWrite(outPin, LOW);
				}
				else if (morse.charAt(j) == '-')
				{
					Serial.println("dash");
					currentTime = millis();
					digitalWrite(outPin, HIGH);
					delay(dashTime);
					digitalWrite(outPin, LOW);
				}
				Serial.println("dotspace");
				currentTime = millis();
				digitalWrite(outPin, HIGH);
				delay(dotTime);
				digitalWrite(outPin, LOW);
			}
			Serial.println("charspace");
			currentTime = millis();
			digitalWrite(outPin, HIGH);
			delay(endCharTime);
			digitalWrite(outPin, LOW);
		}
	}
}
